#!/bin/bash

# –ü—Ä–æ—Å—Ç–æ–π —Ä—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π –¥–ª—è Cash Shifts
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: ./manual_deploy.sh

echo "üöÄ –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π Cash Shifts –Ω–∞ –ø—Ä–æ–¥–∞–∫—à–Ω..."

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /home/workdir/cash_shifts

# –ö–æ–ø–∏—Ä—É–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –≤ –ø—Ä–æ–¥–∞–∫—à–Ω
echo "üìÅ –ö–æ–ø–∏—Ä—É–µ–º —Ñ–∞–π–ª—ã –≤ –ø—Ä–æ–¥–∞–∫—à–Ω..."
cp app.py models.py main.py requirements.txt /var/www/cash-shifts/
cp -r templates/ static/ /var/www/cash-shifts/

# –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ñ–∞–π–ª—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª–∏—Å—å
echo "‚úÖ –§–∞–π–ª—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã:"
ls -la /var/www/cash-shifts/app.py

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–∏—Å (–µ—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–∞–≤–∞)
echo "üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ–º —Å–µ—Ä–≤–∏—Å..."
systemctl restart cash-shifts 2>/dev/null || echo "‚ö†Ô∏è  –ù–µ—Ç –ø—Ä–∞–≤ –¥–ª—è –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞"

# –ñ–¥–µ–º –∑–∞–ø—É—Å–∫–∞
sleep 3

# –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
echo "üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å..."
systemctl status cash-shifts --no-pager | head -5

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–∞–π—Ç–∞
echo "üåê –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–æ–¥–∞–∫—à–Ω —Å–∞–π—Ç..."
curl -s https://cashshifts.tsyndra.ru | head -5

echo "üéâ –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π –∑–∞–≤–µ—Ä—à–µ–Ω!"
echo "üåê –°–∞–π—Ç: https://cashshifts.tsyndra.ru"
